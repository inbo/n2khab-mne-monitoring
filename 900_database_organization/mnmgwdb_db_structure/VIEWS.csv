schema,view,query,rules,SELECT,UPDATE,purpose,excluded
inbound,FieldWork,"SELECT  LOC.*,  FwCAL.teammember_assigned,  FwCAL.activity_rank,  CASE WHEN (FwCAL.date_visit_planned IS NULL) THEN FALSE ELSE TRUE END AS is_scheduled,  FwCAL.date_visit_planned,  FwCAL.date_visit_planned - current_date AS days_to_visit,  FwCAL.date_end - current_date AS days_to_deadline,  FwCAL.notes AS preparation_notes,  VISIT.visit_id,  VISIT.teammember_id,  VISIT.date_visit,  VISIT.notes,  VISIT.photo,  VISIT.issues,  INFO.locationinfo_id,  INFO.accessibility_inaccessible,  INFO.accessibility_revisit,  INFO.recovery_hints,  INFO.landowner,  INFO.watina_code_1,  INFO.watina_code_2,  GAP.activity_group_id,  GAP.is_field_activity,  GAP.is_gw_activity,  GAP.protocols,  COALESCE( WIA.fieldwork_id, CSA.fieldwork_id) AS fieldwork_id,  WIA.photo_soil,  WIA.photo_well,  WIA.watina_code_used_1,  WIA.watina_code_used_2,  WIA.no_diver,  WIA.diver_id,  CSA.lims_code,  VISIT.visit_doneFROM ""inbound"".""Visits"" AS VISITLEFT JOIN ""metadata"".""Locations"" AS LOC  ON LOC.location_id = VISIT.location_idLEFT JOIN ""outbound"".""LocationInfos"" AS INFO  ON INFO.location_id = VISIT.location_idLEFT JOIN ""outbound"".""FieldworkCalendar"" AS FwCAL  ON FwCAL.fieldworkcalendar_id = VISIT.fieldworkcalendar_idLEFT JOIN (  SELECT DISTINCT    activity_group_id,    activity_group,    is_field_activity,    is_gw_activity,    string_agg('' || protocol, E',') AS protocols  FROM ""metadata"".""GroupedActivities"" AS GACT  LEFT JOIN ""metadata"".""Protocols"" AS PRT    ON PRT.protocol_id = GACT.protocol_id  GROUP BY    activity_group_id,    activity_group,    is_field_activity,    is_gw_activity  ) AS GAP  ON GAP.activity_group_id = VISIT.activity_group_idLEFT JOIN ""inbound"".""WellInstallationActivities"" AS WIA  ON VISIT.visit_id = WIA.visit_idLEFT JOIN ""inbound"".""ChemicalSamplingActivities"" AS CSA  ON VISIT.visit_id = CSA.visit_idWHERE TRUE  AND ((FwCAL.no_visit_planned IS NULL) OR (NOT FwCAL.no_visit_planned))  AND NOT FwCAL.excluded  AND GAP.is_gw_activity;","DROP RULE IF EXISTS FieldWork_upd0 ON ""inbound"".""FieldWork"";CREATE RULE FieldWork_upd0 ASON UPDATE TO ""inbound"".""FieldWork""DO INSTEAD UPDATE ""inbound"".""Visits"" SET  teammember_id = NEW.teammember_id,  date_visit = NEW.date_visit,  notes = NEW.notes,  photo = NEW.photo,  issues = NEW.issues,  visit_done = NEW.visit_done WHERE visit_id = OLD.visit_id;DROP RULE IF EXISTS FieldWork_upd1 ON ""inbound"".""FieldWork"";CREATE RULE FieldWork_upd1 ASON UPDATE TO ""inbound"".""FieldWork""DO ALSO UPDATE ""outbound"".""LocationInfos"" SET  accessibility_inaccessible = NEW.accessibility_inaccessible,  accessibility_revisit = NEW.accessibility_revisit,  recovery_hints = NEW.recovery_hints WHERE locationinfo_id = OLD.locationinfo_id;DROP RULE IF EXISTS FieldWork_upd2 ON ""inbound"".""FieldWork"";CREATE RULE FieldWork_upd2 ASON UPDATE TO ""inbound"".""FieldWork""DO ALSO UPDATE ""inbound"".""WellInstallationActivities"" SET  teammember_id = NEW.teammember_id,  date_visit = NEW.date_visit,  photo_soil = NEW.photo_soil,  photo_well = NEW.photo_well,  watina_code_used_1 = NEW.watina_code_used_1,  watina_code_used_2 = NEW.watina_code_used_2,  no_diver = NEW.no_diver,  diver_id = NEW.diver_id,  visit_done = NEW.visit_done WHERE fieldwork_id = OLD.fieldwork_id;DROP RULE IF EXISTS FieldWork_upd3 ON ""inbound"".""FieldWork"";CREATE RULE FieldWork_upd3 ASON UPDATE TO ""inbound"".""FieldWork""DO ALSO UPDATE ""inbound"".""ChemicalSamplingActivities"" SET  teammember_id = NEW.teammember_id,  date_visit = NEW.date_visit,  lims_code = NEW.lims_code,  visit_done = NEW.visit_done WHERE fieldwork_id = OLD.fieldwork_id;","tom,yglinga,jens,lise,wouter,floris,karen,ward,monkey","tom,yglinga,jens,lise,wouter,floris,karen",assemble field visit info groundwater,0
outbound,FieldworkPlanning,"SELECT  LOC.*,  SLOC.scheme_ps_targetpanels,  SSPSTP.stratum_scheme_ps_targetpanels,  SLOC.schemes,  SLOC.strata,  INFO.locationinfo_id,  INFO.accessibility_inaccessible,  INFO.accessibility_revisit,  INFO.landowner,  INFO.recovery_hints,  INFO.watina_code_1,  INFO.watina_code_2,  FWCAL.fieldworkcalendar_id,  FWCAL.samplelocation_id,  FWCAL.date_start,  FWCAL.date_end,  FWCAL.date_interval,  FWCAL.date_end - current_date AS days_to_deadline,  FWCAL.activity_group_id,  FWCAL.activity_group_id IN (    SELECT DISTINCT activity_group_id FROM ""metadata"".""GroupedActivities""    WHERE is_gw_activity  ) AS is_gw_activity,  FWCAL.activity_rank,  FWCAL.priority,  FWCAL.wait_watersurface,  FWCAL.wait_3260,  FWCAL.wait_7220,  (FWCAL.wait_watersurface OR FWCAL.wait_3260 OR FWCAL.wait_7220) AS is_waiting,  FWCAL.excluded,  FWCAL.excluded_reason,  FWCAL.teammember_assigned,  FWCAL.date_visit_planned,  FWCAL.no_visit_planned,  FWCAL.notes,  FWCAL.done_planning,  LOCEVAL.has_loceval,  LOCEVAL.latest_visitFROM ""outbound"".""FieldworkCalendar"" AS FWCALLEFT JOIN ""outbound"".""SampleLocations"" AS SLOC  ON FWCAL.samplelocation_id = SLOC.samplelocation_idLEFT JOIN ""metadata"".""Locations"" AS LOC  ON LOC.location_id = SLOC.location_idLEFT JOIN ""outbound"".""LocationInfos"" AS INFO  ON LOC.location_id = INFO.location_idLEFT JOIN ""metadata"".""SSPSTaPas"" AS SSPSTP  ON SSPSTP.sspstapa_id = FWCAL.sspstapa_idLEFT JOIN (    SELECT DISTINCT      samplelocation_id,      eval_source,      MAX(eval_date) AS latest_visit,      TRUE AS has_loceval    FROM ""outbound"".""LocationEvaluations"" AS LE    WHERE eval_source = 'loceval'    GROUP BY samplelocation_id, eval_source  ) AS LOCEVAL    ON SLOC.samplelocation_id = LOCEVAL.samplelocation_idORDER BY  FWCAL.date_end,  FWCAL.priority,  is_waiting,  SLOC.strata,  FWCAL.grts_address,  FWCAL.activity_rank,  FWCAL.activity_group_id;","DROP RULE IF EXISTS FieldworkPlanning_upd1 ON ""outbound"".""FieldworkPlanning"";CREATE RULE FieldworkPlanning_upd1 ASON UPDATE TO ""outbound"".""FieldworkPlanning""DO INSTEAD UPDATE ""outbound"".""FieldworkCalendar"" SET  excluded = NEW.excluded,  excluded_reason = NEW.excluded_reason,  teammember_assigned = NEW.teammember_assigned,  date_visit_planned = NEW.date_visit_planned,  no_visit_planned = NEW.no_visit_planned,  notes = NEW.notes,  done_planning = NEW.done_planning WHERE fieldworkcalendar_id = OLD.fieldworkcalendar_id;DROP RULE IF EXISTS FieldworkPlanning_upd2 ON ""outbound"".""FieldworkPlanning"";CREATE RULE FieldworkPlanning_upd2 ASON UPDATE TO ""outbound"".""FieldworkPlanning""DO ALSO UPDATE ""outbound"".""LocationInfos"" SET  watina_code_1 = NEW.watina_code_1,  watina_code_2 = NEW.watina_code_2 WHERE locationinfo_id = OLD.locationinfo_id;","tom,yglinga,jens,lise,wouter,floris,karen,ward,monkey","tom,yglinga,jens,lise,wouter,floris,karen",Fieldwork preparation and planning for groundwater-related work,0
outbound,SampleCells,"SELECT *FROM ""metadata"".""LocationCells""WHERE location_id IN (  SELECT DISTINCT location_id  FROM ""outbound"".""SampleLocations"");",,"tom,yglinga,jens,lise,wouter,floris,karen,ward,monkey","tom,yglinga,jens,lise,wouter,floris,karen",Show grts cells of sample locations,0
outbound,LocevalInfo,"SELECT  LOC.*,  LOCEVAL.scheme,  LOCEVAL.type,  LOCEVAL.type_assessed,  LOCEVAL.eval_source,  LOCEVAL.eval_name,  LOCEVAL.eval_date,  LOCEVAL.notes,  LOCEVAL.photoFROM ""outbound"".""LocationEvaluations"" AS LOCEVALLEFT JOIN ""outbound"".""SampleLocations"" AS SLOC  ON (LOCEVAL.samplelocation_id = SLOC.location_id)LEFT JOIN ""metadata"".""Locations"" AS LOC  ON LOC.location_id = SLOC.location_idWHERE TRUE  AND eval_source = 'loceval';",,"tom,yglinga,jens,lise,wouter,floris,karen,ward,monkey",,all infos from loceval,0
