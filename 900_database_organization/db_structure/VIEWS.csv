schema,view,query,rules,SELECT,UPDATE,purpose
outbound,FieldPreparation,"SELECT    ogc_fid,    wkb_geometry,    locationcalendar_id,    type,    type_adjusted,    teammember_assigned,    date_start,    date_end,    visit_date_planned,    is_replaced,    notes,    done_planningFROM ""outbound"".""LocationCalendar""",,"ward,karen,floris","ward,karen,floris",field preparation: partial view of the location calendar
outbound,PriorVisits,"SELECT DISTINCT    iVIS.visit_id,    oCAL.wkb_geometry,    oCAL.locationcalendar_id,    mTEAM.username AS teammember,    CASE WHEN iVIS.type_assessed IS NULL     THEN (       CASE WHEN oCAL.type_adjusted IS NULL        THEN oCAL.type        ELSE oCAL.type_adjusted        END)     ELSE iVIS.type_assessed     END as type,    iVIS.date_visit,    mACT.activity_name,    iVIS.notes AS field_notesFROM ""inbound"".""Visits"" AS iVISLEFT JOIN ""outbound"".""LocationCalendar"" AS oCAL ON iVIS.locationcalendar_id = oCAL.locationcalendar_idLEFT JOIN ""metadata"".""TeamMembers"" AS mTEAM ON iVIS.teammember_id = mTEAM.teammember_idLEFT JOIN ""metadata"".""GroupedActivities"" AS mACT ON mACT.grouped_activity_id = iVIS.grouped_activity_idWHERE iVIS.visit_done",,"ward,karen,floris",,aggregating prior visits for fieldwork preparation
inbound,VisitNotes,"SELECT    ivis.visit_id,    iVIS.locationcalendar_id,    mTEAM.username AS team_assigned,    iVIS.teammember_id,    CASE WHEN oCAL.type_adjusted IS NULL      THEN oCAL.type      ELSE oCAL.type_adjusted      END as type,    iVIS.type_assessed,    oCAL.notes AS preparation_notes,    oCAL.visit_date_planned,    iVIS.date_visit,    iVIS.visit_due,    iVIS.visit_overdue,    iVIS.activity_rank,    mACT.activity_group,    mACT.activity_name,    iVIS.notes AS field_notes,    iVIS.visit_done,    oCAL.wkb_geometryFROM ""inbound"".""Visits"" AS iVISLEFT JOIN ""outbound"".""LocationCalendar"" AS oCAL ON iVIS.locationcalendar_id = oCAL.locationcalendar_idLEFT JOIN ""metadata"".""TeamMembers"" AS mTEAM ON oCAL.teammember_assigned = mTEAM.teammember_idLEFT JOIN ""metadata"".""GroupedActivities"" AS mACT ON mACT.grouped_activity_id = iVIS.grouped_activity_id","DROP RULE IF EXISTS VisitNotes_upd ON ""inbound"".""VisitNotes"";CREATE RULE VisitNotes_upd ASON UPDATE TO ""inbound"".""VisitNotes""DO INSTEAD UPDATE ""inbound"".""Visits"" SET teammember_id = NEW.teammember_id,     type_assessed = NEW.type_assessed,     date_visit = NEW.date_visit,     visit_due = NEW.visit_due,     visit_overdue = NEW.visit_overdue,     activity_rank = NEW.activity_rank,     notes = NEW.field_notes,     visit_done = NEW.visit_done WHERE locationcalendar_id = OLD.locationcalendar_id;","ward,karen,floris","ward,karen,floris",aggregate notes from prior visits
outbound,ReplacementProcessing,"SELECT *FROM ""outbound"".""ReplacementLocations"" AS oREPLWHERE oREPL.locationcalendar_id IN (  SELECT DISTINCT locationcalendar_id  FROM ""outbound"".""LocationCalendar""  WHERE replacement_ongoing AND NOT is_replaced)",,"ward,karen,floris","ward,karen,floris",transient view to handle location replacement
